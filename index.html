<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Random stripes</title>

    <!-- Bootstrap -->
 
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	<link rel="stylesheet" href="css/main.css" type="text/css"/>
	<link rel="stylesheet" href="vendor/colpick.css" type="text/css"/>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
</head>
<body>
<div class="container">
    <h1>Random stripes</h1>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<script src="vendor/colpick.js" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
 
	<div class="row" id="pickers">
		<div class="col-xs-2 col-md-1 colorlabel">
			<div id="picker1" class="colorpicker" ><i class="glyphicon glyphicon-edit"></i> </div>
			Color 1
		</div>
		<div class="col-xs-2 col-md-1 colorlabel">			
			<div id="picker2" class="colorpicker" ><i class="glyphicon glyphicon-edit"></i> </div>			
			Color 2
		</div>
	</div>
	<div class="form-group">
		<input type="text" id="nrows" value="100" size="3" maxlength="3" class="form-control"> rows
	</div>
	<div class="row">
		<div id="pattern" class="col-xs-12">
		</div>
		<div id="instructions" class="col-xs-12">
		</div>
	</div>
	<script type="text/javascript">
$("document").ready(function(){
	var color1 = "1b9117";
	var color2 = "b3e8dc";
	
	$('#picker1').colpick({
		layout:'hex',
		submit:0,
		color: color1,
		onChange: function (hsb,hex,rgb,el){
			$(el).css('background-color', '#'+hex);
			$(".row-1").css('background-color', '#'+hex);
		}
	}).keyup(function(){
		$(this).colpickSetColor(this.value) ;})
	$('#picker2').colpick({
		layout:'hex',
		submit:0,
		color: color2,
		onChange: function (hsb,hex,rgb,el){
			$(el).css('background-color', '#'+hex);
			$(".row-2").css('background-color', '#'+hex);
		}
	}).keyup(function(){
		$(this).colpickSetColor(this.value) ;})


	function generateRows(n){
		var randomRows = [];
		for (var i = 0; i < n; i++){
			var rowClass = "1";
			if (Math.random() < 0.5 ){
				rowClass = "2";
			}		
			randomRows.push(rowClass);
		}
		return randomRows;
	}
	
	function drawRows(rowColors){
		var rowsHTML = "";
		for (var i = 0; i < rowColors.length; i++){
		
			rowsHTML += '<div color="'+rowColors[i]+'" class="row-' + rowColors[i] + ' colorrow"></div>'

		}
		$("#pattern").html(rowsHTML);		
	}

	function createInstructions(rowcolors){
		//var rowcolors = $("#pattern").children().get().reverse();
		var tableHeader = "<thead><th>Row #</th><th>Color</th></thead>";
		var instructions = "<table class='table'>"+tableHeader+"<tbody>";
		var prevColor = rowcolors[0];
		var startRow = 0;
		for (var i = 0; i < rowcolors.length; i++){
			var currentColor = rowcolors[i];
			if (prevColor != currentColor){
				if (startRow + 1 == i){
					instructions += "<tr><td>" + (startRow + 1) + ":</td><td> Color " + prevColor + "</td></tr>";  
				} else {				 
					instructions += "<tr><td>" + (startRow + 1) +"-"+ i + ":</td><td> Color " + prevColor + "</td></tr>";
				}
				startRow = i;
			}
			if (i == rowcolors.length - 1){
				if (startRow == i){
					instructions += "<tr><td>" + (i + 1) + ":</td><td> Color " + currentColor + "</td></tr>";  
				} else {				 
					instructions += "<tr><td>" + (startRow + 1) +"-"+ (i + 1) + ":</td><td> Color " + currentColor + "</td></tr>";
				}				
			}
			prevColor = currentColor;
		}
		instructions += "</tbody></table>";
		$("#instructions").html(instructions);
	}
	
	var nrowsEl = $("#nrows");
	var onNrowsChange = function (){
		var n =  nrowsEl.val();
		regenerate(n);
	};
	nrowsEl.keyup(_.debounce(onNrowsChange, 500));
	
	function regenerate(n){
		var rows = generateRows(n);
		drawRows(rows);
		createInstructions(rows);
		$(".row-1").css('background-color', '#'+color1);
		$(".row-2").css('background-color', '#'+color2);
	}
	
	regenerate(100);
	$("#picker1").css('background-color', '#'+color1);
	$("#picker2").css('background-color', '#'+color2);
	
} );
	</script>
</div> 

</body>
</html>